{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/Test%20Technique/Frontend/frontend/lib/api.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Types\r\nexport interface Document {\r\n  id: string;\r\n  originalName: string;\r\n  objectName: string;\r\n  url: string;\r\n  type: 'legal' | 'financial' | 'other';\r\n  status: 'pending' | 'processing' | 'processed' | 'error';\r\n  size: number;\r\n  mimeType: string;\r\n  extractedText?: string;\r\n  uploadedAt: string;\r\n  processedAt?: string;\r\n  error?: string;\r\n}\r\n\r\nexport interface Report {\r\n  id: string;\r\n  type: 'synthesis' | 'competitive_analysis' | 'business_plan';\r\n  status: 'ready' | 'in_progress' | 'completed' | 'error';\r\n  documentIds: string[];\r\n  content?: string;\r\n  createdAt: string;\r\n  completedAt?: string;\r\n  error?: string;\r\n}\r\n\r\n// Documents API\r\nexport const documentsApi = {\r\n  upload: async (file: File, type?: 'legal' | 'financial' | 'other'): Promise<Document> => {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    const response = await api.post<Document>('/documents/upload', formData, {\r\n      params: { type },\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n    return response.data;\r\n  },\r\n\r\n  process: async (documentId: string): Promise<Document> => {\r\n    const response = await api.post<Document>(`/documents/${documentId}/process`);\r\n    return response.data;\r\n  },\r\n\r\n  getAll: async (): Promise<Document[]> => {\r\n    const response = await api.get<Document[]>('/documents');\r\n    return response.data;\r\n  },\r\n\r\n  getById: async (documentId: string): Promise<Document> => {\r\n    const response = await api.get<Document>(`/documents/${documentId}`);\r\n    return response.data;\r\n  },\r\n\r\n  delete: async (documentId: string): Promise<void> => {\r\n    await api.delete(`/documents/${documentId}`);\r\n  },\r\n};\r\n\r\n// Reports API\r\nexport const reportsApi = {\r\n  create: async (\r\n    type: 'synthesis' | 'competitive_analysis' | 'business_plan',\r\n    documentIds: string[],\r\n  ): Promise<Report> => {\r\n    const response = await api.post<Report>('/reports', { type, documentIds });\r\n    return response.data;\r\n  },\r\n\r\n  generate: async (reportId: string): Promise<Report> => {\r\n    const response = await api.post<Report>(`/reports/${reportId}/generate`);\r\n    return response.data;\r\n  },\r\n\r\n  getAll: async (): Promise<Report[]> => {\r\n    const response = await api.get<Report[]>('/reports');\r\n    return response.data;\r\n  },\r\n\r\n  getById: async (reportId: string): Promise<Report> => {\r\n    const response = await api.get<Report>(`/reports/${reportId}`);\r\n    return response.data;\r\n  },\r\n\r\n  delete: async (reportId: string): Promise<void> => {\r\n    await api.delete(`/reports/${reportId}`);\r\n  },\r\n};\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,eAAe,6DAAmC;AAExD,MAAM,MAAM,sMAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,SAAS;QACP,gBAAgB;IAClB;AACF;AA8BO,MAAM,eAAe;IAC1B,QAAQ,OAAO,MAAY;QACzB,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,QAAQ;QACxB,MAAM,WAAW,MAAM,IAAI,IAAI,CAAW,qBAAqB,UAAU;YACvE,QAAQ;gBAAE;YAAK;YACf,SAAS;gBACP,gBAAgB;YAClB;QACF;QACA,OAAO,SAAS,IAAI;IACtB;IAEA,SAAS,OAAO;QACd,MAAM,WAAW,MAAM,IAAI,IAAI,CAAW,CAAC,WAAW,EAAE,WAAW,QAAQ,CAAC;QAC5E,OAAO,SAAS,IAAI;IACtB;IAEA,QAAQ;QACN,MAAM,WAAW,MAAM,IAAI,GAAG,CAAa;QAC3C,OAAO,SAAS,IAAI;IACtB;IAEA,SAAS,OAAO;QACd,MAAM,WAAW,MAAM,IAAI,GAAG,CAAW,CAAC,WAAW,EAAE,YAAY;QACnE,OAAO,SAAS,IAAI;IACtB;IAEA,QAAQ,OAAO;QACb,MAAM,IAAI,MAAM,CAAC,CAAC,WAAW,EAAE,YAAY;IAC7C;AACF;AAGO,MAAM,aAAa;IACxB,QAAQ,OACN,MACA;QAEA,MAAM,WAAW,MAAM,IAAI,IAAI,CAAS,YAAY;YAAE;YAAM;QAAY;QACxE,OAAO,SAAS,IAAI;IACtB;IAEA,UAAU,OAAO;QACf,MAAM,WAAW,MAAM,IAAI,IAAI,CAAS,CAAC,SAAS,EAAE,SAAS,SAAS,CAAC;QACvE,OAAO,SAAS,IAAI;IACtB;IAEA,QAAQ;QACN,MAAM,WAAW,MAAM,IAAI,GAAG,CAAW;QACzC,OAAO,SAAS,IAAI;IACtB;IAEA,SAAS,OAAO;QACd,MAAM,WAAW,MAAM,IAAI,GAAG,CAAS,CAAC,SAAS,EAAE,UAAU;QAC7D,OAAO,SAAS,IAAI;IACtB;IAEA,QAAQ,OAAO;QACb,MAAM,IAAI,MAAM,CAAC,CAAC,SAAS,EAAE,UAAU;IACzC;AACF;uCAEe"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/Test%20Technique/Frontend/frontend/components/DocumentUpload.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { documentsApi } from '@/lib/api';\r\nimport { Upload, FileText, Loader2 } from 'lucide-react';\r\n\r\nexport default function DocumentUpload() {\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [documentType, setDocumentType] = useState<'legal' | 'financial' | 'other'>('other');\r\n  const queryClient = useQueryClient();\r\n\r\n  const uploadMutation = useMutation({\r\n    mutationFn: async (file: File) => {\r\n      const document = await documentsApi.upload(file, documentType);\r\n      // Traiter automatiquement le document après upload\r\n      await documentsApi.process(document.id);\r\n      return document;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['documents'] });\r\n      setFile(null);\r\n      alert('Document uploadé et traité avec succès !');\r\n    },\r\n    onError: (error: any) => {\r\n      alert(`Erreur: ${error.message}`);\r\n    },\r\n  });\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      setFile(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (file) {\r\n      uploadMutation.mutate(file);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg\">\r\n      <h2 className=\"text-2xl font-bold mb-6 text-gray-800\">Upload de Document</h2>\r\n      \r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            Type de document\r\n          </label>\r\n          <select\r\n            value={documentType}\r\n            onChange={(e) => setDocumentType(e.target.value as any)}\r\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          >\r\n            <option value=\"legal\">Juridique</option>\r\n            <option value=\"financial\">Financier</option>\r\n            <option value=\"other\">Autre</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            Fichier (PDF, Word, TXT)\r\n          </label>\r\n          <div className=\"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-blue-400 transition-colors\">\r\n            <div className=\"space-y-1 text-center\">\r\n              <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />\r\n              <div className=\"flex text-sm text-gray-600\">\r\n                <label className=\"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500\">\r\n                  <span>Sélectionner un fichier</span>\r\n                  <input\r\n                    type=\"file\"\r\n                    className=\"sr-only\"\r\n                    onChange={handleFileChange}\r\n                    accept=\".pdf,.doc,.docx,.txt\"\r\n                  />\r\n                </label>\r\n                <p className=\"pl-1\">ou glisser-déposer</p>\r\n              </div>\r\n              {file && (\r\n                <p className=\"text-xs text-gray-500 mt-2\">\r\n                  {file.name} ({(file.size / 1024 / 1024).toFixed(2)} MB)\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={!file || uploadMutation.isPending}\r\n          className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n        >\r\n          {uploadMutation.isPending ? (\r\n            <>\r\n              <Loader2 className=\"animate-spin h-4 w-4\" />\r\n              Upload en cours...\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Upload className=\"h-4 w-4\" />\r\n              Uploader et Traiter\r\n            </>\r\n          )}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AAAA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,uQAAQ,EAAc;IAC9C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,uQAAQ,EAAkC;IAClF,MAAM,cAAc,IAAA,8PAAc;IAElC,MAAM,iBAAiB,IAAA,mPAAW,EAAC;QACjC,YAAY,OAAO;YACjB,MAAM,WAAW,MAAM,gLAAY,CAAC,MAAM,CAAC,MAAM;YACjD,mDAAmD;YACnD,MAAM,gLAAY,CAAC,OAAO,CAAC,SAAS,EAAE;YACtC,OAAO;QACT;QACA,WAAW;YACT,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAY;YAAC;YACxD,QAAQ;YACR,MAAM;QACR;QACA,SAAS,CAAC;YACR,MAAM,CAAC,QAAQ,EAAE,MAAM,OAAO,EAAE;QAClC;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,IAAI,EAAE,MAAM,CAAC,KAAK,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE;YACvC,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;QAC3B;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IAAI,MAAM;YACR,eAAe,MAAM,CAAC;QACxB;IACF;IAEA,qBACE,oSAAC;QAAI,WAAU;;0BACb,oSAAC;gBAAG,WAAU;0BAAwC;;;;;;0BAEtD,oSAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,oSAAC;;0CACC,oSAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,oSAAC;gCACC,OAAO;gCACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;gCAC/C,WAAU;;kDAEV,oSAAC;wCAAO,OAAM;kDAAQ;;;;;;kDACtB,oSAAC;wCAAO,OAAM;kDAAY;;;;;;kDAC1B,oSAAC;wCAAO,OAAM;kDAAQ;;;;;;;;;;;;;;;;;;kCAI1B,oSAAC;;0CACC,oSAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,oSAAC;gCAAI,WAAU;0CACb,cAAA,oSAAC;oCAAI,WAAU;;sDACb,oSAAC,sQAAM;4CAAC,WAAU;;;;;;sDAClB,oSAAC;4CAAI,WAAU;;8DACb,oSAAC;oDAAM,WAAU;;sEACf,oSAAC;sEAAK;;;;;;sEACN,oSAAC;4DACC,MAAK;4DACL,WAAU;4DACV,UAAU;4DACV,QAAO;;;;;;;;;;;;8DAGX,oSAAC;oDAAE,WAAU;8DAAO;;;;;;;;;;;;wCAErB,sBACC,oSAAC;4CAAE,WAAU;;gDACV,KAAK,IAAI;gDAAC;gDAAG,CAAC,KAAK,IAAI,GAAG,OAAO,IAAI,EAAE,OAAO,CAAC;gDAAG;;;;;;;;;;;;;;;;;;;;;;;;kCAO7D,oSAAC;wBACC,MAAK;wBACL,UAAU,CAAC,QAAQ,eAAe,SAAS;wBAC3C,WAAU;kCAET,eAAe,SAAS,iBACvB;;8CACE,oSAAC,kRAAO;oCAAC,WAAU;;;;;;gCAAyB;;yDAI9C;;8CACE,oSAAC,sQAAM;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;;;;;;;;;AAQ5C"}},
    {"offset": {"line": 432, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/Test%20Technique/Frontend/frontend/components/DocumentList.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { documentsApi, Document } from '@/lib/api';\r\nimport { FileText, Trash2, CheckCircle2, XCircle, Clock, Loader2 } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { fr } from 'date-fns/locale';\r\n\r\nconst statusIcons = {\r\n  pending: <Clock className=\"h-4 w-4 text-yellow-500\" />,\r\n  processing: <Loader2 className=\"h-4 w-4 text-blue-500 animate-spin\" />,\r\n  processed: <CheckCircle2 className=\"h-4 w-4 text-green-500\" />,\r\n  error: <XCircle className=\"h-4 w-4 text-red-500\" />,\r\n};\r\n\r\nconst statusLabels = {\r\n  pending: 'En attente',\r\n  processing: 'En traitement',\r\n  processed: 'Traité',\r\n  error: 'Erreur',\r\n};\r\n\r\nexport default function DocumentList() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: documents, isLoading } = useQuery({\r\n    queryKey: ['documents'],\r\n    queryFn: documentsApi.getAll,\r\n    refetchInterval: 3000, // Rafraîchir toutes les 3 secondes\r\n  });\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: documentsApi.delete,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['documents'] });\r\n    },\r\n  });\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center py-12\">\r\n        <Loader2 className=\"animate-spin h-8 w-8 text-blue-500\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!documents || documents.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12 text-gray-500\">\r\n        <FileText className=\"mx-auto h-12 w-12 mb-4 text-gray-400\" />\r\n        <p>Aucun document uploadé</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Documents</h2>\r\n      <div className=\"grid gap-4\">\r\n        {documents.map((doc) => (\r\n          <div\r\n            key={doc.id}\r\n            className=\"bg-white rounded-lg shadow-md p-4 border border-gray-200 hover:shadow-lg transition-shadow\"\r\n          >\r\n            <div className=\"flex items-start justify-between\">\r\n              <div className=\"flex-1\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <FileText className=\"h-5 w-5 text-gray-600\" />\r\n                  <h3 className=\"font-semibold text-gray-800\">{doc.originalName}</h3>\r\n                </div>\r\n                <div className=\"flex items-center gap-4 text-sm text-gray-600\">\r\n                  <span className=\"flex items-center gap-1\">\r\n                    {statusIcons[doc.status]}\r\n                    {statusLabels[doc.status]}\r\n                  </span>\r\n                  <span>{(doc.size / 1024 / 1024).toFixed(2)} MB</span>\r\n                  <span>\r\n                    {format(new Date(doc.uploadedAt), 'dd MMM yyyy HH:mm', { locale: fr })}\r\n                  </span>\r\n                </div>\r\n                {doc.error && (\r\n                  <p className=\"text-sm text-red-600 mt-2\">Erreur: {doc.error}</p>\r\n                )}\r\n              </div>\r\n              <button\r\n                onClick={() => deleteMutation.mutate(doc.id)}\r\n                className=\"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors\"\r\n                title=\"Supprimer\"\r\n              >\r\n                <Trash2 className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AANA;;;;;;;AAQA,MAAM,cAAc;IAClB,uBAAS,oSAAC,mQAAK;QAAC,WAAU;;;;;;IAC1B,0BAAY,oSAAC,kRAAO;QAAC,WAAU;;;;;;IAC/B,yBAAW,oSAAC,2RAAY;QAAC,WAAU;;;;;;IACnC,qBAAO,oSAAC,6QAAO;QAAC,WAAU;;;;;;AAC5B;AAEA,MAAM,eAAe;IACnB,SAAS;IACT,YAAY;IACZ,WAAW;IACX,OAAO;AACT;AAEe,SAAS;IACtB,MAAM,cAAc,IAAA,8PAAc;IAElC,MAAM,EAAE,MAAM,SAAS,EAAE,SAAS,EAAE,GAAG,IAAA,6OAAQ,EAAC;QAC9C,UAAU;YAAC;SAAY;QACvB,SAAS,gLAAY,CAAC,MAAM;QAC5B,iBAAiB;IACnB;IAEA,MAAM,iBAAiB,IAAA,mPAAW,EAAC;QACjC,YAAY,gLAAY,CAAC,MAAM;QAC/B,WAAW;YACT,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAY;YAAC;QAC1D;IACF;IAEA,IAAI,WAAW;QACb,qBACE,oSAAC;YAAI,WAAU;sBACb,cAAA,oSAAC,kRAAO;gBAAC,WAAU;;;;;;;;;;;IAGzB;IAEA,IAAI,CAAC,aAAa,UAAU,MAAM,KAAK,GAAG;QACxC,qBACE,oSAAC;YAAI,WAAU;;8BACb,oSAAC,gRAAQ;oBAAC,WAAU;;;;;;8BACpB,oSAAC;8BAAE;;;;;;;;;;;;IAGT;IAEA,qBACE,oSAAC;QAAI,WAAU;;0BACb,oSAAC;gBAAG,WAAU;0BAAwC;;;;;;0BACtD,oSAAC;gBAAI,WAAU;0BACZ,UAAU,GAAG,CAAC,CAAC,oBACd,oSAAC;wBAEC,WAAU;kCAEV,cAAA,oSAAC;4BAAI,WAAU;;8CACb,oSAAC;oCAAI,WAAU;;sDACb,oSAAC;4CAAI,WAAU;;8DACb,oSAAC,gRAAQ;oDAAC,WAAU;;;;;;8DACpB,oSAAC;oDAAG,WAAU;8DAA+B,IAAI,YAAY;;;;;;;;;;;;sDAE/D,oSAAC;4CAAI,WAAU;;8DACb,oSAAC;oDAAK,WAAU;;wDACb,WAAW,CAAC,IAAI,MAAM,CAAC;wDACvB,YAAY,CAAC,IAAI,MAAM,CAAC;;;;;;;8DAE3B,oSAAC;;wDAAM,CAAC,IAAI,IAAI,GAAG,OAAO,IAAI,EAAE,OAAO,CAAC;wDAAG;;;;;;;8DAC3C,oSAAC;8DACE,IAAA,qNAAM,EAAC,IAAI,KAAK,IAAI,UAAU,GAAG,qBAAqB;wDAAE,QAAQ,uMAAE;oDAAC;;;;;;;;;;;;wCAGvE,IAAI,KAAK,kBACR,oSAAC;4CAAE,WAAU;;gDAA4B;gDAAS,IAAI,KAAK;;;;;;;;;;;;;8CAG/D,oSAAC;oCACC,SAAS,IAAM,eAAe,MAAM,CAAC,IAAI,EAAE;oCAC3C,WAAU;oCACV,OAAM;8CAEN,cAAA,oSAAC,0QAAM;wCAAC,WAAU;;;;;;;;;;;;;;;;;uBA5BjB,IAAI,EAAE;;;;;;;;;;;;;;;;AAoCvB"}},
    {"offset": {"line": 696, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/Test%20Technique/Frontend/frontend/components/ReportGenerator.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { reportsApi, documentsApi, Report } from '@/lib/api';\r\nimport { FileText, Sparkles, Loader2, CheckCircle2, XCircle, Clock } from 'lucide-react';\r\n\r\nconst reportTypes = {\r\n  synthesis: {\r\n    label: 'Synthèse Globale',\r\n    description: 'Résumé complet et structuré des documents',\r\n    icon: <FileText className=\"h-6 w-6\" />,\r\n  },\r\n  competitive_analysis: {\r\n    label: 'Analyse Concurrentielle',\r\n    description: 'Analyse approfondie de la concurrence',\r\n    icon: <Sparkles className=\"h-6 w-6\" />,\r\n  },\r\n  business_plan: {\r\n    label: 'Business Plan',\r\n    description: 'Plan d\\'affaires complet et professionnel',\r\n    icon: <FileText className=\"h-6 w-6\" />,\r\n  },\r\n};\r\n\r\nconst statusIcons = {\r\n  ready: <Clock className=\"h-4 w-4 text-yellow-500\" />,\r\n  in_progress: <Loader2 className=\"h-4 w-4 text-blue-500 animate-spin\" />,\r\n  completed: <CheckCircle2 className=\"h-4 w-4 text-green-500\" />,\r\n  error: <XCircle className=\"h-4 w-4 text-red-500\" />,\r\n};\r\n\r\nconst statusLabels = {\r\n  ready: 'Prêt',\r\n  in_progress: 'En cours',\r\n  completed: 'Terminé',\r\n  error: 'Erreur',\r\n};\r\n\r\nexport default function ReportGenerator() {\r\n  const [selectedType, setSelectedType] = useState<'synthesis' | 'competitive_analysis' | 'business_plan'>('synthesis');\r\n  const [selectedDocuments, setSelectedDocuments] = useState<string[]>([]);\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: documents } = useQuery({\r\n    queryKey: ['documents'],\r\n    queryFn: documentsApi.getAll,\r\n  });\r\n\r\n  const { data: reports } = useQuery({\r\n    queryKey: ['reports'],\r\n    queryFn: reportsApi.getAll,\r\n    refetchInterval: 2000,\r\n  });\r\n\r\n  const createReportMutation = useMutation({\r\n    mutationFn: async (data: { type: string; documentIds: string[] }) => {\r\n      console.log('Creating report with:', { type: data.type, documentIds: data.documentIds });\r\n      \r\n      if (!data.type) {\r\n        throw new Error('Le type de rapport est requis');\r\n      }\r\n      \r\n      const report = await reportsApi.create(data.type as any, data.documentIds);\r\n      await reportsApi.generate(report.id);\r\n      return report;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['reports'] });\r\n      setSelectedDocuments([]);\r\n      alert('Rapport créé et génération démarrée !');\r\n    },\r\n    onError: (error: any) => {\r\n      alert(`Erreur: ${error.message}`);\r\n    },\r\n  });\r\n\r\n  const processedDocuments = documents?.filter((d) => d.status === 'processed') || [];\r\n\r\n  const handleDocumentToggle = (docId: string) => {\r\n    setSelectedDocuments((prev) =>\r\n      prev.includes(docId) ? prev.filter((id) => id !== docId) : [...prev, docId],\r\n    );\r\n  };\r\n\r\n  const handleGenerate = () => {\r\n    if (selectedDocuments.length === 0) {\r\n      alert('Veuillez sélectionner au moins un document traité');\r\n      return;\r\n    }\r\n    if (!selectedType) {\r\n      alert('Veuillez sélectionner un type de rapport');\r\n      return;\r\n    }\r\n    createReportMutation.mutate({\r\n      type: selectedType,\r\n      documentIds: selectedDocuments,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n        <h2 className=\"text-2xl font-bold mb-6 text-gray-800\">Générer un Rapport IA</h2>\r\n\r\n        <div className=\"mb-6\">\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\r\n            Type de rapport\r\n          </label>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            {Object.entries(reportTypes).map(([key, config]) => (\r\n              <button\r\n                key={key}\r\n                onClick={() => setSelectedType(key as any)}\r\n                className={`p-4 border-2 rounded-lg text-left transition-all ${\r\n                  selectedType === key\r\n                    ? 'border-blue-500 bg-blue-50'\r\n                    : 'border-gray-200 hover:border-gray-300'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center gap-2 mb-2 text-gray-700\">\r\n                  {config.icon}\r\n                  <span className=\"font-semibold\">{config.label}</span>\r\n                </div>\r\n                <p className=\"text-sm text-gray-600\">{config.description}</p>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mb-6\">\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\r\n            Documents à analyser (sélectionner au moins un document traité)\r\n          </label>\r\n          {processedDocuments.length === 0 ? (\r\n            <p className=\"text-gray-500 text-sm\">\r\n              Aucun document traité disponible. Veuillez d'abord uploader et traiter des documents.\r\n            </p>\r\n          ) : (\r\n            <div className=\"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-md p-3\">\r\n              {processedDocuments.map((doc) => (\r\n                <label\r\n                  key={doc.id}\r\n                  className=\"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer\"\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedDocuments.includes(doc.id)}\r\n                    onChange={() => handleDocumentToggle(doc.id)}\r\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                  />\r\n                  <span className=\"text-sm text-gray-700\">{doc.originalName}</span>\r\n                </label>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleGenerate}\r\n          disabled={selectedDocuments.length === 0 || createReportMutation.isPending}\r\n          className=\"w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n        >\r\n          {createReportMutation.isPending ? (\r\n            <>\r\n              <Loader2 className=\"animate-spin h-5 w-5\" />\r\n              Génération en cours...\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Sparkles className=\"h-5 w-5\" />\r\n              Générer le Rapport\r\n            </>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {reports && reports.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n          <h3 className=\"text-xl font-bold mb-4 text-gray-800\">Rapports Générés</h3>\r\n          <div className=\"space-y-4\">\r\n            {reports.map((report) => (\r\n              <ReportCard key={report.id} report={report} />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ReportCard({ report }: { report: Report }) {\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n\r\n  return (\r\n    <div className=\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div className=\"flex-1\">\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            {statusIcons[report.status]}\r\n            <h4 className=\"font-semibold text-gray-800\">\r\n              {reportTypes[report.type]?.label || report.type}\r\n            </h4>\r\n            <span className=\"text-sm text-gray-500\">\r\n              ({report.documentIds.length} document{report.documentIds.length > 1 ? 's' : ''})\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\r\n            <span>{statusLabels[report.status]}</span>\r\n            <span>\r\n              {new Date(report.createdAt).toLocaleDateString('fr-FR', {\r\n                day: 'numeric',\r\n                month: 'short',\r\n                year: 'numeric',\r\n                hour: '2-digit',\r\n                minute: '2-digit',\r\n              })}\r\n            </span>\r\n          </div>\r\n          {report.error && (\r\n            <p className=\"text-sm text-red-600 mb-2\">Erreur: {report.error}</p>\r\n          )}\r\n          {report.status === 'completed' && report.content && (\r\n            <button\r\n              onClick={() => setIsExpanded(!isExpanded)}\r\n              className=\"text-sm text-blue-600 hover:text-blue-700\"\r\n            >\r\n              {isExpanded ? 'Masquer' : 'Afficher'} le rapport\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {isExpanded && report.content && (\r\n        <div className=\"mt-4 p-4 bg-gray-50 rounded-md max-h-96 overflow-y-auto\">\r\n          <pre className=\"whitespace-pre-wrap text-sm text-gray-700 font-sans\">\r\n            {report.content}\r\n          </pre>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/Test%20Technique/Frontend/frontend/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport DocumentUpload from '@/components/DocumentUpload';\nimport DocumentList from '@/components/DocumentList';\nimport ReportGenerator from '@/components/ReportGenerator';\nimport { useState, useEffect } from 'react';\nimport { io, Socket } from 'socket.io-client';\n\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      refetchOnWindowFocus: false,\n    },\n  },\n});\n\nexport default function Home() {\n  const [socket, setSocket] = useState<Socket | null>(null);\n\n  useEffect(() => {\n    // Connexion WebSocket pour les mises à jour en temps réel\n    const newSocket = io(process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001', {\n      transports: ['websocket'],\n    });\n\n    newSocket.on('connect', () => {\n      console.log('Connecté au serveur WebSocket');\n    });\n\n    newSocket.on('report:update', (report) => {\n      console.log('Mise à jour du rapport:', report);\n      queryClient.invalidateQueries({ queryKey: ['reports'] });\n    });\n\n    newSocket.on('document:update', (document) => {\n      console.log('Mise à jour du document:', document);\n      queryClient.invalidateQueries({ queryKey: ['documents'] });\n    });\n\n    setSocket(newSocket);\n\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <div className=\"min-h-screen bg-gray-50\">\n        <header className=\"bg-white shadow-sm border-b border-gray-200\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n            <h1 className=\"text-3xl font-bold text-gray-900\">\n              Gestion de Documents Juridiques et Financiers\n            </h1>\n            <p className=\"mt-2 text-gray-600\">\n              Upload, analyse et génération de rapports avec IA\n            </p>\n          </div>\n        </header>\n\n        <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"space-y-8\">\n            {/* Section Upload */}\n            <section>\n              <DocumentUpload />\n            </section>\n\n            {/* Section Documents */}\n            <section>\n              <DocumentList />\n            </section>\n\n            {/* Section Génération de Rapports */}\n            <section>\n              <ReportGenerator />\n            </section>\n          </div>\n        </main>\n\n        <footer className=\"bg-white border-t border-gray-200 mt-12\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n            <p className=\"text-center text-gray-500 text-sm\">\n              Système de gestion de documents avec IA - Powered by Groq & MinIO\n            </p>\n          </div>\n        </footer>\n      </div>\n    </QueryClientProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AASA,MAAM,cAAc,IAAI,kPAAW,CAAC;IAClC,gBAAgB;QACd,SAAS;YACP,sBAAsB;QACxB;IACF;AACF;AAEe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,uQAAQ,EAAgB;IAEpD,IAAA,wQAAS,EAAC;QACR,0DAA0D;QAC1D,MAAM,YAAY,IAAA,oPAAE,EAAC,6DAAmC,yBAAyB;YAC/E,YAAY;gBAAC;aAAY;QAC3B;QAEA,UAAU,EAAE,CAAC,WAAW;YACtB,QAAQ,GAAG,CAAC;QACd;QAEA,UAAU,EAAE,CAAC,iBAAiB,CAAC;YAC7B,QAAQ,GAAG,CAAC,2BAA2B;YACvC,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAU;YAAC;QACxD;QAEA,UAAU,EAAE,CAAC,mBAAmB,CAAC;YAC/B,QAAQ,GAAG,CAAC,4BAA4B;YACxC,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAY;YAAC;QAC1D;QAEA,UAAU;QAEV,OAAO;YACL,UAAU,KAAK;QACjB;IACF,GAAG,EAAE;IAEL,qBACE,oSAAC,mQAAmB;QAAC,QAAQ;kBAC3B,cAAA,oSAAC;YAAI,WAAU;;8BACb,oSAAC;oBAAO,WAAU;8BAChB,cAAA,oSAAC;wBAAI,WAAU;;0CACb,oSAAC;gCAAG,WAAU;0CAAmC;;;;;;0CAGjD,oSAAC;gCAAE,WAAU;0CAAqB;;;;;;;;;;;;;;;;;8BAMtC,oSAAC;oBAAK,WAAU;8BACd,cAAA,oSAAC;wBAAI,WAAU;;0CAEb,oSAAC;0CACC,cAAA,oSAAC,8LAAc;;;;;;;;;;0CAIjB,oSAAC;0CACC,cAAA,oSAAC,4LAAY;;;;;;;;;;0CAIf,oSAAC;0CACC,cAAA,oSAAC,+LAAe;;;;;;;;;;;;;;;;;;;;;8BAKtB,oSAAC;oBAAO,WAAU;8BAChB,cAAA,oSAAC;wBAAI,WAAU;kCACb,cAAA,oSAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ7D"}}]
}